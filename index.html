<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>MC Hosting Panel</title>

<style>
body{
    margin:0;
    font-family:Inter,Arial;
    background:#0f172a;
    color:#e5e7eb;
}
header{
    background:#020617;
    padding:16px;
    font-size:20px;
    font-weight:700;
}
#app{display:flex;height:100vh}
aside{
    width:220px;
    background:#020617;
    padding:10px;
}
aside button{
    width:100%;
    padding:10px;
    margin:4px 0;
    background:#020617;
    border:0;
    color:#e5e7eb;
    text-align:left;
    cursor:pointer;
}
aside button:hover{background:#1e293b}

main{flex:1;padding:20px}

.hidden{display:none}

.card{
    background:#020617;
    padding:16px;
    border-radius:8px;
    margin-bottom:16px;
}

button.primary{background:#22c55e;color:#000}
button.danger{background:#ef4444}
button{padding:8px 14px;border:0;border-radius:4px;font-weight:600}

#console{
    background:#000;
    color:#0f0;
    padding:10px;
    height:300px;
    overflow:auto;
    font-family:monospace;
}
input{
    width:100%;
    padding:8px;
    margin:6px 0;
}
</style>
</head>

<body>

<header>ðŸŸ© Minecraft Hosting Panel</header>

<div id="app">
<aside>
    <button onclick="view('servers')">Servers</button>
    <button onclick="view('console')">Console</button>
    <button onclick="view('settings')">Settings</button>
    <button onclick="logout()">Logout</button>
</aside>

<main>

<!-- LOGIN -->
<div id="login" class="card">
<h2>Login</h2>
<input id="email" placeholder="email">
<input id="password" type="password" placeholder="password">
<button class="primary" onclick="login()">LOGIN</button>
</div>

<!-- SERVERS -->
<div id="servers" class="card hidden">
<h2>Your Servers</h2>
<div id="serverList"></div>
</div>

<!-- CONSOLE -->
<div id="consoleView" class="card hidden">
<h2>Console</h2>
<button class="primary" onclick="action('start')">START</button>
<button onclick="action('stop')">STOP</button>
<button onclick="action('restart')">RESTART</button>
<button class="danger" onclick="action('kill')">KILL</button>
<pre id="console"></pre>
</div>

<!-- SETTINGS -->
<div id="settings" class="card hidden">
<h2>Account</h2>
<p>Subusers, limity, plany â€“ backend</p>
</div>

</main>
</div>

<script>
const API = "https://TWOJ-VPS-IP:3000"; // <- ZMIENISZ
let token = localStorage.getItem("token");
let currentServer = null;

function view(id){
    document.querySelectorAll('.card').forEach(x=>x.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
}

function login(){
    fetch(API+"/login",{
        method:"POST",
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({
            email:email.value,
            password:password.value
        })
    })
    .then(r=>r.json())
    .then(d=>{
        token=d.token;
        localStorage.setItem("token",token);
        loadServers();
        view('servers');
    });
}

function logout(){
    localStorage.removeItem("token");
    location.reload();
}

function loadServers(){
    fetch(API+"/servers",{
        headers:{Authorization:"Bearer "+token}
    })
    .then(r=>r.json())
    .then(d=>{
        const s=document.getElementById('serverList');
        s.innerHTML='';
        d.forEach(x=>{
            const div=document.createElement('div');
            div.innerHTML=`
                <b>${x.name}</b><br>
                RAM: ${x.ram}MB<br>
                <button onclick="openConsole('${x.id}')">OPEN</button>
            `;
            s.appendChild(div);
        });
    });
}

function openConsole(id){
    currentServer=id;
    view('consoleView');
    loadConsole();
}

function action(a){
    fetch(API+`/servers/${currentServer}/${a}`,{
        method:"POST",
        headers:{Authorization:"Bearer "+token}
    });
}

function loadConsole(){
    fetch(API+`/servers/${currentServer}/logs`,{
        headers:{Authorization:"Bearer "+token}
    })
    .then(r=>r.text())
    .then(t=>{
        console.textContent=t;
        setTimeout(loadConsole,2000);
    });
}

if(token){
    loadServers();
    view('servers');
}
</script>

</body>
</html>
