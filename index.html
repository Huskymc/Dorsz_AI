<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Dorsz 1.3</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0e0e0e;
  color: #fff;
  display: flex;
  height: 100vh;
}

/* SIDEBAR */
#sidebar {
  width: 260px;
  background: #151515;
  padding: 10px;
  display: flex;
  flex-direction: column;
}

#sidebar h2 { margin: 0 0 10px; }

#sidebar button {
  background: #1f1f1f;
  color: #fff;
  border: none;
  padding: 10px;
  margin-bottom: 5px;
  cursor: pointer;
}

#sidebar button:hover { background: #2a2a2a; }

/* MAIN */
#main { flex: 1; display: flex; flex-direction: column; }

#topbar {
  height: 50px;
  background: #111;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 10px;
  border-bottom: 1px solid #222;
}

#chat {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
}

.msg {
  margin-bottom: 12px;
  padding: 10px;
  border-radius: 6px;
  max-width: 80%;
}

.user { background: #1e3a5f; align-self: flex-end; }

.assistant { background: #1f1f1f; align-self: flex-start; }

/* INPUT */
#inputBar { display: flex; border-top: 1px solid #222; }

#input {
  flex: 1;
  padding: 12px;
  background: #111;
  color: #fff;
  border: none;
  outline: none;
  font-size: 15px;
}

#sendBtn {
  padding: 12px 20px;
  background: #2b2b2b;
  color: #fff;
  border: none;
  cursor: pointer;
}

#sendBtn:hover { background: #3a3a3a; }
</style>
</head>

<body>

<!-- SIDEBAR -->
<div id="sidebar">
  <h2>ğŸŸ Dorsz</h2>
  <button onclick="newChat()">â• Nowy czat</button>
  <button>Czat</button>
  <button>Obrazy</button>
</div>

<!-- MAIN -->
<div id="main">
  <div id="topbar">
    <div>Dorsz 1.3</div>
    <div>
      <button>UdostÄ™pnij</button>
      <button>â‹®</button>
    </div>
  </div>

  <div id="chat"></div>

  <div id="inputBar">
    <input id="input" placeholder="Napisz do Dorszaâ€¦" />
    <button id="sendBtn" onclick="sendMessage()">WyÅ›lij</button>
  </div>
</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");
let memory = [];

/* ENTER */
input.addEventListener("keydown", e => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

/* MESSAGE UI */
function addMessage(role, text) {
  const div = document.createElement("div");
  div.className = "msg " + role;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

/* LOGIKA DORSZA */
function analyze(text) {
  const t = text.toLowerCase().trim();

  if (/^(hej|siemka|siema|elo|czeÅ›Ä‡|witaj)/.test(t)) return "Hej ğŸ‘‹ W czym mogÄ™ pomÃ³c?";
  if (t.includes("skrypt")) return "Jaki skrypt? Java, JS, HTML, Minecraft, plugin?";
  if (t.includes("plugin")) return "Na jakÄ… wersjÄ™? Paper, Spigot, Velocity?";
  if (t.includes("bÅ‚Ä…d") || t.includes("error")) return "Wklej kod albo logi â€“ przeanalizujÄ™.";
  if (t.includes("html")) return "Chcesz caÅ‚y plik HTML czy tylko fragment?";
  if (t.includes("java")) return "Jaka wersja Javy i co dokÅ‚adnie nie dziaÅ‚a?";
  if (t.length < 3) return "Napisz trochÄ™ wiÄ™cej ğŸ™‚";

  return "Rozumiem. Opisz dokÅ‚adniej, co chcesz zrobiÄ‡.";
}

/* SEND */
function sendMessage() {
  const text = input.value.trim();
  if (!text) return;

  addMessage("user", text);
  memory.push({ role: "user", text });
  input.value = "";

  // Dodaj tymczasowÄ… wiadomoÅ›Ä‡ AI tylko raz
  const aiIndex = memory.push({ role: "assistant", text: "AnalizujÄ™ problemâ€¦" }) - 1;
  addMessage("assistant", "AnalizujÄ™ problemâ€¦");

  // Animacja literka po literce
  setTimeout(() => {
    const reply = analyze(text);
    let idx = 0;
    const interval = setInterval(() => {
      memory[aiIndex].text = reply.slice(0, idx + 1);
      chat.lastChild.textContent = memory[aiIndex].text;
      chat.scrollTop = chat.scrollHeight;
      idx++;
      if (idx >= reply.length) clearInterval(interval);
    }, 30);
  }, 200);
}

/* NEW CHAT */
function newChat() {
  chat.innerHTML = "";
  memory = [];
  addMessage("assistant", "Nowy czat. W czym mogÄ™ pomÃ³c?");
}

/* START */
addMessage("assistant", "Hej! Jestem Dorsz ğŸŸ Jak mogÄ™ pomÃ³c?");
</script>

</body>
</html>
